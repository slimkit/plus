(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{164:function(s,t,n){"use strict";n.r(t);var a=n(0),e=Object(a.a)({},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"content"},[s._m(0),s._v(" "),s._m(1),s._v(" "),n("p",[s._v("并且，我们以 PHP-CLI 安装并使用 PHP 内嵌 Server 运行了预览站点，本章利用前面所学的知识，进行一个完整站点的发布。")]),s._v(" "),s._m(2),s._v(" "),n("p",[s._v("在发布前，我们需要运行一个 FastCGI 程序，这个程序就是我们在安装 PHP 的时候安装的 FPM 了，这个专门用于以 CGI 进行 PHP 程序的处理。现在我们运行下面的命令查看 FPM 状态：")]),s._v(" "),s._m(3),n("p",[s._v("教程中无法保证你的服务器上的 FPM 是否已经被启动，我们可以运行：")]),s._v(" "),s._m(4),n("p",[s._v("把 FPM 相关的进程都杀死，接下来，我们来启动 FPM 程序把：")]),s._v(" "),s._m(5),s._m(6),s._v(" "),s._m(7),s._m(8),s._v(" "),s._m(9),s._m(10),s._v(" "),s._m(11),s._v(" "),s._m(12),s._m(13),s._v(" "),s._m(14),s._m(15),s._v(" "),n("p",[s._v("接下来，我们运行下面的命令创建目录，并将所有权赋予给 nginx 用户：")]),s._v(" "),s._m(16),s._m(17),s._v(" "),s._m(18),s._m(19),s._v(" "),s._m(20),s._m(21),s._v(" "),s._m(22),s._v(" "),n("p",[s._v("我们在运行站点前，需要对一些 Plus 软件目录的权限做一些修改，当然，这不是必须的，本步骤也可能不是很全面，在运行过程中可以逐步完成！")]),s._v(" "),s._m(23),s._v(" "),s._m(24),s._v(" "),s._m(25),s._v(" "),n("p",[s._v("权限设置完成后我们来发布站点吧！运行下面的命令：")]),s._v(" "),s._m(26),n("p",[s._v("然后现在用你电脑的浏览器打开你服务器的 IP，你会看到下面的界面：")]),s._v(" "),n("img",{attrs:{src:s.$withBase("/assets/img/guide/installation/view-plus-site-default.png")}}),s._v(" "),s._m(27),s._v(" "),s._m(28),s._v(" "),s._m(29)])},[function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("在前面的章节中，我们在 "),t("strong",[this._v("CentOS")]),this._v(" "),t("code",[this._v("7.4")]),this._v(" 的系统上安装了如下软件：")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ul",[n("li",[n("strong",[s._v("PHP")]),s._v(" 7.2")]),s._v(" "),n("li",[n("strong",[s._v("MySQL")]),s._v(" 5.7")]),s._v(" "),n("li",[n("strong",[s._v("Nginx")]),s._v(" 1.15")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("h2",{attrs:{id:"php-fpm-启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#php-fpm-启动","aria-hidden":"true"}},[this._v("#")]),this._v(" PHP-FPM 启动")])},function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("systemctl status php-fpm\n")])]),this._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[this._v("1")]),t("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("systemctl "),t("span",{attrs:{class:"token function"}},[this._v("kill")]),this._v(" php-fpm\n")])]),this._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[this._v("1")]),t("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("systemctl start php-fpm\n")])]),this._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[this._v("1")]),t("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("在之前安装的 FPM 中，我们使用的默认端口，所以现在运行 "),t("code",[this._v("netstat -anp | grep 9000")]),this._v(" 命令，看是否输出如下内容：")])},function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("tcp        0      0 127.0.0.1:9000          0.0.0.0:*               LISTEN      19854/php-fpm: mast\n")])]),this._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[this._v("1")]),t("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("如果输出大概类似上面的内容，则说明我们已经成功运行了，如果你还是不确定，我们可以运行 "),t("code",[this._v("systemctl status php-fpm")]),this._v(" 命令，你会看到类似下面的内容：")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('php-fpm.service - The PHP FastCGI Process Manager\n   Loaded: loaded (/usr/lib/systemd/system/php-fpm.service; disabled; vendor preset: disabled)\n   Active: active (running) since Wed 2018-09-26 11:26:30 CST; 5s ago\n Main PID: 19854 (php-fpm)\n   Status: "Ready to handle connections"\n   CGroup: /system.slice/php-fpm.service\n           ├─19854 php-fpm: master process (/usr/local/php/etc/php-fpm.conf)\n           ├─19855 php-fpm: pool www\n           └─19856 php-fpm: pool www\n\nSep 26 11:26:30 iZbp1dknyxm2bmfb4tlxjcZ systemd[1]: Starting The PHP FastCGI Process Manager...\nSep 26 11:26:30 iZbp1dknyxm2bmfb4tlxjcZ systemd[1]: Started The PHP FastCGI Process Manager.\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("h2",{attrs:{id:"增加-nginx-server"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#增加-nginx-server","aria-hidden":"true"}},[this._v("#")]),this._v(" 增加 Nginx Server")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("首先，我们应该清除 Ngin 默认配置中的 server，因为我们之前将 Nginx 安装在 "),t("code",[this._v("/usr/local/nginx")]),this._v(" 目录中，所以我们使用 Vim 打开 "),t("code",[this._v("/usr/local/nginx/nginx.conf")]),this._v(" 文件，你会看到如下内容：")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"language-nginx line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-nginx"}},[n("code",[n("span",{attrs:{class:"token comment"}},[s._v("#user  nobody;")]),s._v("\n"),n("span",{attrs:{class:"token keyword"}},[s._v("worker_processes")]),s._v("  "),n("span",{attrs:{class:"token number"}},[s._v("1")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{attrs:{class:"token comment"}},[s._v("#error_log  logs/error.log;")]),s._v("\n"),n("span",{attrs:{class:"token comment"}},[s._v("#error_log  logs/error.log  notice;")]),s._v("\n"),n("span",{attrs:{class:"token comment"}},[s._v("#error_log  logs/error.log  info;")]),s._v("\n\n"),n("span",{attrs:{class:"token comment"}},[s._v("#pid        logs/nginx.pid;")]),s._v("\n\n\n"),n("span",{attrs:{class:"token keyword"}},[s._v("events")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{attrs:{class:"token keyword"}},[s._v("worker_connections")]),s._v("  "),n("span",{attrs:{class:"token number"}},[s._v("1024")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n"),n("span",{attrs:{class:"token keyword"}},[s._v("http")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{attrs:{class:"token keyword"}},[s._v("include")]),s._v("       mime"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token keyword"}},[s._v("types")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{attrs:{class:"token keyword"}},[s._v("default_type")]),s._v("  application"),n("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("octet"),n("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v("stream"),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '")]),s._v("\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#                  '$status $body_bytes_sent \"$http_referer\" '")]),s._v("\n    "),n("span",{attrs:{class:"token comment"}},[s._v('#                  \'"$http_user_agent" "$http_x_forwarded_for"\';')]),s._v("\n\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#access_log  logs/access.log  main;")]),s._v("\n\n    "),n("span",{attrs:{class:"token keyword"}},[s._v("sendfile")]),s._v("        on"),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#tcp_nopush     on;")]),s._v("\n\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#keepalive_timeout  0;")]),s._v("\n    "),n("span",{attrs:{class:"token keyword"}},[s._v("keepalive_timeout")]),s._v("  "),n("span",{attrs:{class:"token number"}},[s._v("65")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#gzip  on;")]),s._v("\n\n    "),n("span",{attrs:{class:"token keyword"}},[s._v("server")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{attrs:{class:"token keyword"}},[s._v("listen")]),s._v("       "),n("span",{attrs:{class:"token number"}},[s._v("80")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{attrs:{class:"token keyword"}},[s._v("server_name")]),s._v("  localhost"),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),n("span",{attrs:{class:"token comment"}},[s._v("#charset koi8-r;")]),s._v("\n\n        "),n("span",{attrs:{class:"token comment"}},[s._v("#access_log  logs/host.access.log  main;")]),s._v("\n\n        "),n("span",{attrs:{class:"token keyword"}},[s._v("location")]),s._v(" "),n("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{attrs:{class:"token keyword"}},[s._v("root")]),s._v("   html"),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),n("span",{attrs:{class:"token keyword"}},[s._v("index")]),s._v("  "),n("span",{attrs:{class:"token keyword"}},[s._v("index")]),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("html "),n("span",{attrs:{class:"token keyword"}},[s._v("index")]),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("htm"),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),n("span",{attrs:{class:"token comment"}},[s._v("#error_page  404              /404.html;")]),s._v("\n\n        "),n("span",{attrs:{class:"token comment"}},[s._v("# redirect server error pages to the static page /50x.html")]),s._v("\n        "),n("span",{attrs:{class:"token comment"}},[s._v("#")]),s._v("\n        "),n("span",{attrs:{class:"token keyword"}},[s._v("error_page")]),s._v("   "),n("span",{attrs:{class:"token number"}},[s._v("500")]),s._v(" "),n("span",{attrs:{class:"token number"}},[s._v("502")]),s._v(" "),n("span",{attrs:{class:"token number"}},[s._v("503")]),s._v(" "),n("span",{attrs:{class:"token number"}},[s._v("504")]),s._v("  "),n("span",{attrs:{class:"token operator"}},[s._v("/")]),n("span",{attrs:{class:"token number"}},[s._v("50")]),s._v("x"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("html"),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{attrs:{class:"token keyword"}},[s._v("location")]),s._v(" "),n("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{attrs:{class:"token operator"}},[s._v("/")]),n("span",{attrs:{class:"token number"}},[s._v("50")]),s._v("x"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("html "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{attrs:{class:"token keyword"}},[s._v("root")]),s._v("   html"),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),n("span",{attrs:{class:"token comment"}},[s._v("# proxy the PHP scripts to Apache listening on 127.0.0.1:80")]),s._v("\n        "),n("span",{attrs:{class:"token comment"}},[s._v("#")]),s._v("\n        "),n("span",{attrs:{class:"token comment"}},[s._v("#location ~ \\.php$ {")]),s._v("\n        "),n("span",{attrs:{class:"token comment"}},[s._v("#    proxy_pass   http://127.0.0.1;")]),s._v("\n        "),n("span",{attrs:{class:"token comment"}},[s._v("#}")]),s._v("\n\n        "),n("span",{attrs:{class:"token comment"}},[s._v("# pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000")]),s._v("\n        "),n("span",{attrs:{class:"token comment"}},[s._v("#")]),s._v("\n        "),n("span",{attrs:{class:"token comment"}},[s._v("#location ~ \\.php$ {")]),s._v("\n        "),n("span",{attrs:{class:"token comment"}},[s._v("#    root           html;")]),s._v("\n        "),n("span",{attrs:{class:"token comment"}},[s._v("#    fastcgi_pass   127.0.0.1:9000;")]),s._v("\n        "),n("span",{attrs:{class:"token comment"}},[s._v("#    fastcgi_index  index.php;")]),s._v("\n        "),n("span",{attrs:{class:"token comment"}},[s._v("#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;")]),s._v("\n        "),n("span",{attrs:{class:"token comment"}},[s._v("#    include        fastcgi_params;")]),s._v("\n        "),n("span",{attrs:{class:"token comment"}},[s._v("#}")]),s._v("\n\n        "),n("span",{attrs:{class:"token comment"}},[s._v("# deny access to .htaccess files, if Apache's document root")]),s._v("\n        "),n("span",{attrs:{class:"token comment"}},[s._v("# concurs with nginx's one")]),s._v("\n        "),n("span",{attrs:{class:"token comment"}},[s._v("#")]),s._v("\n        "),n("span",{attrs:{class:"token comment"}},[s._v("#location ~ /\\.ht {")]),s._v("\n        "),n("span",{attrs:{class:"token comment"}},[s._v("#    deny  all;")]),s._v("\n        "),n("span",{attrs:{class:"token comment"}},[s._v("#}")]),s._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n    "),n("span",{attrs:{class:"token comment"}},[s._v("# another virtual host using mix of IP-, name-, and port-based configuration")]),s._v("\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#")]),s._v("\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#server {")]),s._v("\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#    listen       8000;")]),s._v("\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#    listen       somename:8080;")]),s._v("\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#    server_name  somename  alias  another.alias;")]),s._v("\n\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#    location / {")]),s._v("\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#        root   html;")]),s._v("\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#        index  index.html index.htm;")]),s._v("\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#    }")]),s._v("\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#}")]),s._v("\n\n\n    "),n("span",{attrs:{class:"token comment"}},[s._v("# HTTPS server")]),s._v("\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#")]),s._v("\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#server {")]),s._v("\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#    listen       443 ssl;")]),s._v("\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#    server_name  localhost;")]),s._v("\n\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#    ssl_certificate      cert.pem;")]),s._v("\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#    ssl_certificate_key  cert.key;")]),s._v("\n\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#    ssl_session_cache    shared:SSL:1m;")]),s._v("\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#    ssl_session_timeout  5m;")]),s._v("\n\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#    ssl_ciphers  HIGH:!aNULL:!MD5;")]),s._v("\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#    ssl_prefer_server_ciphers  on;")]),s._v("\n\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#    location / {")]),s._v("\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#        root   html;")]),s._v("\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#        index  index.html index.htm;")]),s._v("\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#    }")]),s._v("\n    "),n("span",{attrs:{class:"token comment"}},[s._v("#}")]),s._v("\n\n"),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br"),n("span",{staticClass:"line-number"},[s._v("115")]),n("br"),n("span",{staticClass:"line-number"},[s._v("116")]),n("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("我们把配置中的 server 项全部添加 "),t("code",[this._v("#")]),this._v(" 在前面进行注释。然后在 http 这个块中增加一条规则如下：")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"language-nginx line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-nginx"}},[n("code",[n("span",{attrs:{class:"token comment"}},[s._v("# ...")]),s._v("\n"),n("span",{attrs:{class:"token keyword"}},[s._v("http")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{attrs:{class:"token comment"}},[s._v("# ...")]),s._v("\n    "),n("span",{attrs:{class:"token keyword"}},[s._v("include")]),s._v(" vhost"),n("span",{attrs:{class:"token operator"}},[s._v("/")]),n("span",{attrs:{class:"token operator"}},[s._v("*")]),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf"),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{attrs:{class:"token comment"}},[s._v("# ...")]),s._v("\n"),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("blockquote",[t("p",[this._v("上面的其他配置我用 "),t("code",[this._v("# ...")]),this._v(" 代替，增加的是 "),t("code",[this._v("include vhost/*.conf")]),this._v(" 这一条！")])])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /usr/local/nginx/vhost "),n("span",{attrs:{class:"token operator"}},[s._v("&&")]),s._v(" \\\n"),n("span",{attrs:{class:"token function"}},[s._v("chown")]),s._v(" nginx:nginx /usr/local/nginx/vhost\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("接下来，我们使用 "),t("code",[this._v("touch /usr/local/nginx/vhost/plus.conf")]),this._v(" 命令创建一个名为 "),t("code",[this._v("plus.conf")]),this._v(" 的文件在 "),t("code",[this._v("vhost")]),this._v(" 文件夹下，并写入下面的内容：")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"language-nginx line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-nginx"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[s._v("server")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{attrs:{class:"token keyword"}},[s._v("listen")]),s._v(" "),n("span",{attrs:{class:"token number"}},[s._v("80")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{attrs:{class:"token keyword"}},[s._v("server_name")]),s._v(" localhost"),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{attrs:{class:"token comment"}},[s._v("# 暂时使用 localhost，之后替换为域名。")]),s._v("\n    "),n("span",{attrs:{class:"token keyword"}},[s._v("root")]),s._v(" "),n("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),n("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),n("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("src"),n("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("plus"),n("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("public"),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{attrs:{class:"token comment"}},[s._v("# 这里设置我们 Plus 程序目录下的 public 目录绝对位置")]),s._v("\n    "),n("span",{attrs:{class:"token keyword"}},[s._v("index")]),s._v(" "),n("span",{attrs:{class:"token keyword"}},[s._v("index")]),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("php "),n("span",{attrs:{class:"token keyword"}},[s._v("index")]),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("html"),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),n("span",{attrs:{class:"token keyword"}},[s._v("location")]),s._v(" "),n("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{attrs:{class:"token keyword"}},[s._v("try_files")]),s._v(" "),n("span",{attrs:{class:"token variable"}},[s._v("$uri")]),s._v(" "),n("span",{attrs:{class:"token variable"}},[s._v("$uri")]),n("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),n("span",{attrs:{class:"token operator"}},[s._v("/")]),n("span",{attrs:{class:"token keyword"}},[s._v("index")]),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("php"),n("span",{attrs:{class:"token variable"}},[s._v("$is_args")]),n("span",{attrs:{class:"token variable"}},[s._v("$args")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),n("span",{attrs:{class:"token keyword"}},[s._v("location")]),s._v(" "),n("span",{attrs:{class:"token operator"}},[s._v("~")]),s._v(" \\"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("php$ "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{attrs:{class:"token keyword"}},[s._v("try_files")]),s._v(" "),n("span",{attrs:{class:"token variable"}},[s._v("$uri")]),s._v(" "),n("span",{attrs:{class:"token operator"}},[s._v("/")]),n("span",{attrs:{class:"token keyword"}},[s._v("index")]),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("php "),n("span",{attrs:{class:"token operator"}},[s._v("=")]),n("span",{attrs:{class:"token number"}},[s._v("404")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{attrs:{class:"token keyword"}},[s._v("fastcgi_pass")]),s._v(" "),n("span",{attrs:{class:"token number"}},[s._v("127.0")]),n("span",{attrs:{class:"token number"}},[s._v(".0")]),n("span",{attrs:{class:"token number"}},[s._v(".1")]),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{attrs:{class:"token number"}},[s._v("9000")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{attrs:{class:"token keyword"}},[s._v("fastcgi_index")]),s._v(" "),n("span",{attrs:{class:"token keyword"}},[s._v("index")]),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("php"),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{attrs:{class:"token keyword"}},[s._v("fastcgi_buffers")]),s._v(" "),n("span",{attrs:{class:"token number"}},[s._v("16")]),s._v(" "),n("span",{attrs:{class:"token number"}},[s._v("16")]),s._v("k"),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{attrs:{class:"token comment"}},[s._v("# 这里以后需要酌情调整")]),s._v("\n        "),n("span",{attrs:{class:"token keyword"}},[s._v("fastcgi_buffer_size")]),s._v(" "),n("span",{attrs:{class:"token number"}},[s._v("32")]),s._v("k"),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),n("span",{attrs:{class:"token comment"}},[s._v("# 这里以后需要酌情调整")]),s._v("\n        "),n("span",{attrs:{class:"token keyword"}},[s._v("fastcgi_param")]),s._v(" SCRIPT_FILENAME "),n("span",{attrs:{class:"token variable"}},[s._v("$document_root")]),n("span",{attrs:{class:"token variable"}},[s._v("$fastcgi_script_name")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{attrs:{class:"token keyword"}},[s._v("include")]),s._v(" fastcgi_params"),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),n("span",{attrs:{class:"token keyword"}},[s._v("location")]),s._v(" "),n("span",{attrs:{class:"token operator"}},[s._v("~")]),s._v(" "),n("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("\\"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ht "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{attrs:{class:"token keyword"}},[s._v("deny")]),s._v(" all"),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("写入完成后，我们输入 "),t("code",[this._v("nginx -t")]),this._v(" 命令来检查一下配置是否正确，如正确，会输出下面的内容：")])},function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("nginx: the configuration file /usr/local/nginx/nginx.conf syntax is ok\nnginx: configuration file /usr/local/nginx/nginx.conf test is successful\n")])]),this._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[this._v("1")]),t("br"),t("span",{staticClass:"line-number"},[this._v("2")]),t("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("如果你 Nginx 已经运行请来了，请运行 "),t("code",[this._v("nginx -s stop")]),this._v(" 进行关闭！")])},function(){var s=this.$createElement,t=this._self._c||s;return t("h2",{attrs:{id:"站点权限"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#站点权限","aria-hidden":"true"}},[this._v("#")]),this._v(" 站点权限")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("下面所说的目录，都是基于 "),t("code",[this._v("/usr/local/src/plus")]),this._v(" 为根，为了避免一些错误，请你现在运行 "),t("code",[this._v("cd /usr/local/src/plus")]),this._v(" 命令，进入该目录。")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ol",[n("li",[s._v("赋予权限目录所属用户"),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{attrs:{class:"token function"}},[s._v("chown")]),s._v(" -R php-fpm:php-fpm /usr/local/src/plus\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])]),s._v(" "),n("li",[s._v("设置特定目录权限"),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{attrs:{class:"token function"}},[s._v("chmod")]),s._v(" -R 0777 /usr/local/src/plus/storage\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])])])},function(){var s=this.$createElement,t=this._self._c||s;return t("h2",{attrs:{id:"运行站点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#运行站点","aria-hidden":"true"}},[this._v("#")]),this._v(" 运行站点")])},function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("nginx\n")])]),this._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[this._v("1")]),t("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("现在，你可以点击右上角的登录按钮，然后你的账号密码都是 "),t("code",[this._v("root")]),this._v(" 点击登录按钮试试看吧！")])},function(){var s=this.$createElement,t=this._self._c||s;return t("h2",{attrs:{id:"细节问题处理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#细节问题处理","aria-hidden":"true"}},[this._v("#")]),this._v(" 细节问题处理")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ol",[n("li",[s._v("我们打开 Plus 程序的 "),n("code",[s._v("storage/configure/plus.yml")]),s._v(" 文件，将里面的 "),n("code",[s._v("app.url")]),s._v(" 这一项，修改为你服务器的 IP，记住一定要携带 "),n("strong",[s._v("http://")]),s._v(" 协议哟！")]),s._v(" "),n("li",[s._v("推荐点击首页的 "),n("code",[s._v("ADMINISTRATION")]),s._v(" 按钮或者网址后面输入 "),n("code",[s._v("/admin")]),s._v(" 进入后台，修改用户密码，然后进入「用户中心」- 「角色管理」然后设置「创始人、普通用户」点击「管理按钮」页面拉到底部勾选「签到管理、发布分享」两个权限，否则你前台 API 是会提示没有权限发布动态的哟。")]),s._v(" "),n("li",[s._v("点击左边侧栏的「存储管理」将里面的内容进行设置，否则无法更新用户头像之类的哟！")]),s._v(" "),n("li",[s._v("点击 CDN 管理，按照页面的指示进行配置，默认是本地公开，你在 Plus 程序目录运行 "),n("code",[s._v("php artisan storage:link")]),s._v(" 命令！否则上传的动态图片之类的会 404 的。")]),s._v(" "),n("li",[s._v("如果你想前台使用 root 帐号登录，请修改 root 帐号密码，否则是无法登陆的，并且去掉 root 帐号的「禁用用户组」")])])}],!1,null,null,null);e.options.__file="using-nginx-and-fpm-publish-website.md";t.default=e.exports}}]);